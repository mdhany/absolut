<!DOCTYPE html>
<html>
<head>
    <title>Facebook Login JavaScript Example</title>
    <meta charset="UTF-8">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
</head>
<body>
<script>
    $(document).ready(function() {
        $.ajaxSetup({ cache: true });
        $.getScript('//connect.facebook.net/en_UK/all.js', function(){
            FB.init({
                appId: '837510712948874',
                cookie     : true,
                xfbml      : true,
                version    : 'v2.1'
            });
            $('#loginbutton,#feedbutton').removeAttr('disabled');
            FB.getLoginStatus(updateStatusCallback);
        });

        function updateStatusCallback(response) {
            console.log('statusChangeCallback');
            console.log(response);
            // The response object is returned with a status field that lets the
            // app know the current login status of the person.
            // Full docs on the response object can be found in the documentation
            // for FB.getLoginStatus().
            if (response.status === 'connected') {
                // Logged into your app and Facebook.
                accionfb();
            } else if (response.status === 'not_authorized') {
                // The person is logged into Facebook, but not your app.
                document.getElementById('status').innerHTML = 'Please log ' +
                        'into this app.';
            } else {
                // The person is not logged into Facebook, so we're not sure if
                // they are logged into this app or not.
                document.getElementById('status').innerHTML = 'Please log ' +
                        'into Facebook.';
            }
        }

        function accionfb() {
            var urlimg = "http://www.desmotivar.com/img/desmotivaciones/108901_en-la-vida-hay-que-caer--levantarse-amar.jpg"
            FB.api(
                    "/me/photos",
                    "POST",
                    {
                        "url": urlimg,
                        "message": "Compartiendo",
                        "place": "186521351396339"
                    },
                    function (response) {
                        if (response && !response.error) {
                            /* handle the result */
                            console.log('Imagen Publicada:'+ response.id);
                            var idphoto = response.id
                            tagueando(idphoto);



                        } else {
                            console.log(response.error)
                        }
                    }
            );

        }
        function tagueando(idphoto) {
            FB.api(
                    "/"+idphoto+"/tags",
                    "POST",
                    {
                        "tags": "[{'tag_uid':'AaKiSg5940Scd9xArpAquaSEzEIo7n3xVM2GSSLqBwp3SXiOVpj2wr9FIGaEOZNJBfv-cKKnsIv5QIiCK4HLRw8FQ-Bj-Q5fzAfzfd1gpshsCg'}]"
                    },
                    function (response) {
                        if (response && !response.error) {
                            /* handle the result */
                            console.log('Tageando amigos:' + response);
                        } else {
                            console.log(response.error)
                        }
                    }
            );
        }
    });
</script>

<!--
  Below we include the Login Button social plugin. This button uses
  the JavaScript SDK to present a graphical Login button that triggers
  the FB.login() function when clicked.
-->

<fb:login-button scope="public_profile,email,publish_actions,user_friends,user_photos" onlogin="checkLoginState();">
</fb:login-button>

<div id="status">
</div>

<ul id="users">
</ul>


</body>
</html>